From 14b1b0afa559ebe2700d290bb82b6ef64cc6d2bf Mon Sep 17 00:00:00 2001
From: Rolando Espinoza <rndmax84@gmail.com>
Date: Wed, 1 Mar 2017 16:26:29 -0300
Subject: [PATCH 1/3] Backport windows build flags

---
 pystan/model.py | 7 +++++++
 setup.py        | 7 +++++++
 2 files changed, 14 insertions(+)

diff --git a/pystan/model.py b/pystan/model.py
index 3ca80ac..af124a4 100644
--- a/pystan/model.py
+++ b/pystan/model.py
@@ -19,6 +19,7 @@ import itertools
 import logging
 from numbers import Number
 import os
+import platform
 import shutil
 import string
 import sys
@@ -280,6 +281,12 @@ class StanModel:
             '-Wno-uninitialized',
         ]
 
+        if platform.platform().startswith('Win'):
+            extra_compile_args = [
+                '/EHsc',
+                '-DBOOST_DATE_TIME_NO_LIB',
+            ]
+
         distutils.log.set_verbosity(verbose)
         extension = Extension(name=self.module_name,
                               language="c++",
diff --git a/setup.py b/setup.py
index 546125c..a40c3ca 100644
--- a/setup.py
+++ b/setup.py
@@ -25,6 +25,7 @@
 import ast
 import codecs
 import os
+import platform
 import sys
 
 LONG_DESCRIPTION = open('README.rst').read()
@@ -114,6 +115,12 @@ extra_compile_args = [
     '-Wno-uninitialized',
 ]
 
+if platform.platform().startswith('Win'):
+    extra_compile_args = [
+        '/EHsc',
+        '-DBOOST_DATE_TIME_NO_LIB',
+    ]
+
 stanc_sources = [
     "pystan/stan/src/stan/lang/ast_def.cpp",
     "pystan/stan/src/stan/lang/grammars/bare_type_grammar_inst.cpp",
-- 
2.6.2

